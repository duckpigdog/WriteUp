# LAMPSecurity: CTF7

项目地址：https://download.vulnhub.com/lampsecurity/CTF7plusDocs.zip

是一个打包好的镜像文件

**注意：导入 vmx 时一定要选择我已移动，否则没网**

使用 Nmap 扫描出开放服务及操作系统版本

![](https://pic1.imgdb.cn/item/69798381a3d6d770e81d9f12.png)

## SQL

### Create account

```sql
123' and (length(database())=5) and '1'='1
```

![](https://pic1.imgdb.cn/item/6979b74ee6c1ecde597ce199.png)

### profile

![](https://pic1.imgdb.cn/item/6979b949e6c1ecde597cea2e.png)

### Please log in（两个）

![](https://pic1.imgdb.cn/item/69799e08e6c1ecde597cb22b.png)

### Reservations Delete

抓包删除给参数 `id` 添加单引号报错

![](https://pic1.imgdb.cn/item/6979a26ce6c1ecde597cbabc.png)

### Users Edit

![](https://pic1.imgdb.cn/item/6979a4c7e6c1ecde597cbbc8.png)

### Reservations Delete

这里同样存在 SQL 注入

![](https://pic1.imgdb.cn/item/6979bcb47c9b4dd81b6161d1.png)

## XSS

### Please log in（两个反射）

抓取登录包加单引号发现报错

![](https://pic1.imgdb.cn/item/6979a133e6c1ecde597cba27.png)

两个参数都存在反射型 XSS

![](https://pic1.imgdb.cn/item/6979a185e6c1ecde597cba49.png)

![](https://pic1.imgdb.cn/item/6979a19be6c1ecde597cba5b.png)

### Reservations Delete（反射）

一模一样的套路，这个 `id` 参数同样存在 SQL 注入

![](https://pic1.imgdb.cn/item/6979a4aae6c1ecde597cbbb9.png)

### Users Edit（反射）

![](https://pic1.imgdb.cn/item/6979a4c7e6c1ecde597cbbc8.png)

### Add a new Training（两个存储）

![](https://pic1.imgdb.cn/item/6979a57ee6c1ecde597cbc2e.png)

![](https://pic1.imgdb.cn/item/6979a5afe6c1ecde597cbc53.png)

第二个则是在前台弹窗了

![](https://pic1.imgdb.cn/item/6979a665e6c1ecde597cc400.png)

### Edit Reading（三个存储）

![](https://pic1.imgdb.cn/item/6979aa60e6c1ecde597cc65b.png)

![](https://pic1.imgdb.cn/item/6979aa92e6c1ecde597cc674.png)

![](https://pic1.imgdb.cn/item/6979aabbe6c1ecde597cc692.png)

![](https://pic1.imgdb.cn/item/6979aac5e6c1ecde597cc69d.png)

### Create account（反射）

测试 SQL 注入发现回显参数值

![](https://pic1.imgdb.cn/item/6979b56fe6c1ecde597cdab4.png)

![](https://pic1.imgdb.cn/item/6979b665e6c1ecde597cddfc.png)

### Newsletters（两个存储）

![](https://pic1.imgdb.cn/item/6979b79ee6c1ecde597ce303.png)

![](https://pic1.imgdb.cn/item/6979b7b6e6c1ecde597ce361.png)

第二个需要在前台访问

![](https://pic1.imgdb.cn/item/6979b7e5e6c1ecde597ce44a.png)

### Your Profile（两个存储）

![](https://pic1.imgdb.cn/item/6979b8e8e6c1ecde597ce8a9.png)

![](https://pic1.imgdb.cn/item/6979b85be6c1ecde597ce669.png)

![](https://pic1.imgdb.cn/item/6979b868e6c1ecde597ce686.png)

### Register for Training（十个存储）

每个框都存在

![](https://pic1.imgdb.cn/item/6979bc91e6c1ecde597cef6e.png)

## 弱口令

### Please log in

使用万能密码登录

```sql
admin' or 1=1 #
```

![](https://pic1.imgdb.cn/item/6979a018e6c1ecde597cb9b7.png)

### SSH

继承在 SQL 注入的基础上

![](https://pic1.imgdb.cn/item/6979adace6c1ecde597cc83f.png)

```bash
brian:my2cents
```

![](https://pic1.imgdb.cn/item/6979ae7ce6c1ecde597cc8b3.png)

## RCE

### Edit Reading

存在文件上传漏洞

![](https://pic1.imgdb.cn/item/6979aa60e6c1ecde597cc65b.png)

扫描后台发现静态文件夹

![](https://pic1.imgdb.cn/item/6979abc7e6c1ecde597cc733.png)

进去看到 WebShell

![](https://pic1.imgdb.cn/item/6979abb1e6c1ecde597cc725.png)

## 提权

### Python 升级为交互式 Shell

```bash
python -c 'import pty;pty.spawn("/bin/bash")'
```

发现数据库默认密码为空

```bash
cat db.php
```

![](https://pic1.imgdb.cn/item/6979ad1ae6c1ecde597cc7e6.png)

登录成功

```bash
mysql -u root -p
```

![](https://pic1.imgdb.cn/item/6979ad5ce6c1ecde597cc824.png)

脱库拿到所有账号密码

![](https://pic1.imgdb.cn/item/6979adace6c1ecde597cc83f.png)

通过 SSH 连接 `brian` 用户

![](https://pic1.imgdb.cn/item/6979ae7ce6c1ecde597cc8b3.png)

### Sudo

直接提权

![](https://pic1.imgdb.cn/item/6979ae9ee6c1ecde597cc8e0.png)